<!DOCTYPE html>
<html>
    <head>
        <title>Settings</title>
        <meta name="author" content="jbuhacoff">
        
        <script>
			
			$(document).ready(function () {
				$("#image_format").hide();
				$("#gotoUploadWindow").click(function () {
					var OpenWindow = window.open("/v1/html5/public/director-html5/file_upload_window.html", "_blank", "width=500,height=500,resizable=no");
					OpenWindow.image_deployments_parent = $("#image_type").val();
					if($("#image_type").val() == 'VM'){
						OpenWindow.image_format_parent = 'qcow2';
						} else {
						OpenWindow.image_format_parent = $("#image_format").val();
					}
					OpenWindow.auth_token_parent=mainViewModel.loginViewModel.userProfile.authorizationToken();	
				});
				
				fetchDeploymentType();
				//fetchImageFormat();
			});
			
			function fetchDeploymentType() {
				
				$.ajax({
					type : "GET",
					url : "/v1/image-deployments",
					dataType : "json",
					success : function(data) {
						var option=""; 
						for (var i=0; i < data.image_deployments.length; i++){
							if(data.image_deployments[i].name != "BareMetal"){
								option += '<option value="'+ data.image_deployments[i].name + '">' + data.image_deployments[i].display_name + '</option>';
							}
						}
						$('#image_type').append(option);
					}
				});
				
			};
			
			function fetchImageFormat() {
				
				$.ajax({
					type : "GET",
					url : "/v1/image-formats",
					dataType : "json",
					success : function(data) {
						var option=""; 
						for (var i=0; i < data.image_formats.length; i++){ 
							option += '<option value="'+ data.image_formats[i].name + '">' + data.image_formats[i].display_name + '</option>'; 
						}
						$('#image_format').append(option);
					}
				});
				
			};

			function goToTrustPolicyPage(){
			$( "#upload-to-td" ).removeClass('active');
			$( "#director-trust-policy" ).addClass('active');

				$("#bm-dashboard-main-page").hide();
				$("#vm-dashboard-main-page").show();

	
			var isEmpty = !$.trim($("#vm-dashboard-main-page").html());

			if (isEmpty == false) {
				$("#vm-dashboard-main-page").html("");
			}
			hideLoading();
			$("#vm-dashboard-main-page").load(
					"/v1/html5/public/director-html5/vm_images_page.html");
			umount_image();
		
			}
		</script>
		
	</head>
    <body>
		
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8" style="margin-top: 10px;">        
                <div class="panel panel-default" data-bind="with: settingsViewModel">
                    <div class="panel-heading">
                        <h1>Upload To Trust Director</h1>
					</div>
                    <div class="panel-body">
						<div class="row">
							<div class="form-group">
								<label class="control-label col-md-4" for="image_type"><span class="pull-right">Image Type:</span></label>
								<div class="col-md-4">
									<select class="form-control" id="image_type">
										
									</select>
								</div>
								<div class="col-md-4"></div>
							</div>
						</div>
						<br />
						<div class="row">
							<div class="form-group">
								<div class="col-md-2"></div>
								<div class="col-md-8">
									Supported Image Formats : qcow2, vhd, ami, raw
								</div>
								<div class="col-md-2"></div>
							<!--								<label class="control-label col-md-4" for="supported_format"><span class="pull-right">Supported  Image Formats:</span></label>
								<div class="col-md-4">
									<div id = "supported_format">QCOW2</div>
									<select class="form-control" id="image_format">
										
									</select>
								</div>
							<div class="col-md-4"></div> -->
							</div>
						</div>
						<br />
						<div class="row">
							<div class="form-group">
								<div class="col-md-2"></div>
								<div class="col-md-5">
									<button id="gotoUploadWindow" class="btn btn-primary">Next</button>
								</div>
								<div class="col-md-5">
								<button id="gotoUploadWindow" class="btn btn-primary" onclick="goToTrustPolicyPage()" >Go to Trust Policy Page</button></div>
							</div>						</div>      
					</div>
				</div>
			</div>
			
			<div class="col-md-2"></div>
			
		</div>
		
	</body>
</html>
