<!DOCTYPE html>
<html>
    <head>
        <title>Dashboard Button</title>
        <meta name="author" content="jbuhacoff">


 <script type="text/javascript">
function refreshPieChart(){
	var myPieChart = document.getElementById('chart').getContext("2d");
		var canvas_legend = document.getElementById("canvasLegend");
		var delay = 1000; 
		setTimeout(function() {
			function loadPage(){
			$.ajax({
				type : "GET",
				data : "",
				url : "/v1/dashboard/pieChart",
				dataType : "json",
				cache : false,
				success : function(response) {

					console.log(response);
					var options = {
						segmentShowStroke : false,
						animateRotate : true,
						animateScale : false,
						percentageInnerCutout : 50,
						showTooltips: false
					};
					var pieChart = new Chart(myPieChart).Pie(response);
					canvas_legend.innerHTML = pieChart.generateLegend();
				},
				error : function(response) {
					alert('Error while request..');
				}
			});
		};

		window.onload = loadPage();
		

		}, delay);
}



function refereshDashboardGrid() {

	console.log("dashboard js loaded");
	function myRecentPolicies() {
		$.ajax({
				type : "GET",
					url : "/v1/dashboard/trustpolicies/47AF9302-BEC9-4385-98DD-8185C9F7353F/currentuser",
					dataType : "json",
					success : function(result) {
						$("#myRecentPolicies").jsGrid({
							height : "300%",
							width : "100%",
							sorting : true,
							paging : true,
							pageSize : 10,
							pageButtonCount : 5,
							data : result,
							fields : [ {
								title : "Image Name",
								name : "name",
								type : "text",
								align : "center",

								width : 75
							}, {
								title : "Image Format",
								name : "image_format",
								type : "text",
								align : "center",

								width : 75
							}, {
								title : "Created Date",
								name : "created_date",
								type : "text",
								align : "center",

								width : 75
							}, {
								title : "Edited Date",
								name : "edited_date",
								type : "text",
								align : "center",

								width : 75
							}

							]

						});
						var delay = 1000; 
						setTimeout(function() {
							$("#myRecentPolicies").show();
							$("#myRecentPolicies").jsGrid("refresh");
						}, delay);


					}

				});

	}
</script>





    </head>
    <body>


<ul>
<li ><a href="#director-dashboard" data-toggle="tab"  onclick="refereshDashboardGrid(); refreshPieChart()" >Dashboard</a></li>
</ul>





    </body>
</html>
